<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Gallery Slider Lokal</title>
  <style>
    body {
      text-align: center;
      font-family: sans-serif;
      padding: 20px;
    }
    img {
      width: 90%;
      max-width: 400px;
      margin: 20px 0;
      border-radius: 0;
      box-shadow: none;
    }
    button, select {
      padding: 10px 20px;
      margin: 5px;
      font-size: 16px;
      border: none;
      border-radius: 8px;
    }
    button {
      background-color: #007bff;
      color: white;
      cursor: pointer;
    }
    button:disabled {
      background-color: gray;
      cursor: not-allowed;
    }
    select {
      background-color: #f0f0f0;
    }
    #pageNumber {
      margin-top: -10px;
      margin-bottom: 20px;
      font-size: 16px;
      color: #555;
    }
    input[type="text"] {
      width: 90%;
      max-width: 400px;
      padding: 10px;
      font-size: 16px;
      margin-bottom: 10px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>

  <h1>Preview Gambar</h1>

  <input type="text" id="urlInput" placeholder="Masukkan link dasar (contoh: https://example.com/img/)" />
  <br>
  <label for="extSelect">Jenis Gambar:</label>
  <select id="extSelect">
    <option value="auto">Auto</option>
    <option value="jpg">.jpg</option>
    <option value="png">.png</option>
    <option value="webp">.webp</option>
  </select>
  <br>

  <div id="pageNumber">Halaman: 1</div>
  <img id="preview" src="" alt="Gambar tidak tersedia">
  <br>
  <button id="prevBtn" onclick="changeImage(-1)" disabled>&larr; Kiri</button>
  <button onclick="changeImage(1)">Kanan &rarr;</button>

  <script>
    let currentIndex = 1;
    let baseURL = "https://www.wow.com/2020/";
    const img = document.getElementById("preview");
    const page = document.getElementById("pageNumber");
    const prevBtn = document.getElementById("prevBtn");
    const urlInput = document.getElementById("urlInput");
    const extSelect = document.getElementById("extSelect");

    // Update URL saat input berubah
    urlInput.addEventListener("change", () => {
      baseURL = urlInput.value.trim();
      currentIndex = 1;
      updateImage();
    });

    // Pilih ekstensi gambar manual
    extSelect.addEventListener("change", () => {
      updateImage();
    });

    // Update gambar dan nomor halaman
    function updateImage() {
      page.textContent = `Halaman: ${currentIndex}`;
      prevBtn.disabled = currentIndex === 1;

      const extChoice = extSelect.value;
      let customURL = baseURL;

      // Cek apakah URL sudah punya ekstensi gambar
      if (customURL.match(/\.(jpg|png|webp)$/)) {
        // Ganti angka terakhir dengan nomor halaman (jaga ekstensi tetap)
        customURL = customURL.replace(/\d+\.(jpg|png|webp)$/, `${currentIndex}.$1`);
        img.src = customURL;
        return;
      }

      // Kalau user pilih auto, coba semua ekstensi
      if (extChoice === "auto") {
        tryExtensions(["jpg", "png", "webp"]);
      } else {
        img.src = `${baseURL}${currentIndex}.${extChoice}`;
      }
    }

    // Coba ekstensi gambar satu per satu
    function tryExtensions(exts) {
      if (exts.length === 0) {
        img.src = ""; // gagal semua
        return;
      }
      const ext = exts.shift();
      const testImg = new Image();
      testImg.onload = () => {
        img.src = testImg.src;
      };
      testImg.onerror = () => {
        tryExtensions(exts);
      };
      testImg.src = `${baseURL}${currentIndex}.${ext}`;
    }

    // Navigasi gambar (kanan/kiri)
    function changeImage(dir) {
      if (dir === -1 && currentIndex > 1) {
        currentIndex--;
      } else if (dir === 1) {
        currentIndex++;
      }
      updateImage();
    }

    // Init awal
    updateImage();
  </script>

</body>
</html>
